/* jquery.sparkline 2.1.1 - http://omnipotent.net/jquery.sparkline/ 
** Licensed under the New BSD License - see above site for details */
(function(f){"function"===typeof define&&define.amd?define(["jquery"],f):f(jQuery)})(function(f){var E={},p,y,C,F,B,G,O,P,H,Q,R,S,D,T,U,z,I,V,W,X,J,K,L,Y,M,N,t,Z=0;p=function(){var a,b;a=function(){this.init.apply(this,arguments)};1<arguments.length?(arguments[0]?(a.prototype=f.extend(new arguments[0],arguments[arguments.length-1]),a._super=arguments[0].prototype):a.prototype=arguments[arguments.length-1],2<arguments.length&&(b=Array.prototype.slice.call(arguments,1,-1),b.unshift(a.prototype),f.extend.apply(f, b))):a.prototype=arguments[0];return a.prototype.cls=a};f.SPFormatClass=y=p({fre:/\{\{([\w.]+?)(:(.+?))?\}\}/g,precre:/(\w+)\.(\d+)/,init:function(a,b){this.format=a;this.fclass=b},render:function(a,b,c){var d=this,e,g,m,f,j;return this.format.replace(this.fre,function(h,l,n,r){g=l;m=r;(e=d.precre.exec(g))?(j=e[2],g=e[1]):j=!1;f=a[g];if(void 0===f)return"";if(m&&b&&b[m])return h=b[m],h.get?b[m].get(f)||f:b[m][f]||f;P(f)&&(f=c.get("numberFormatter")?c.get("numberFormatter")(f):S(f,j,c.get("numberDigitGroupCount"), c.get("numberDigitGroupSep"),c.get("numberDecimalMark")));return f})}});f.spformat=function(a,b){return new y(a,b)};C=function(a,b,c){return a<b?b:a>c?c:a};F=function(a,b){var c;if(2===b)return c=Math.floor(a.length/2),a.length%2?a[c]:(a[c-1]+a[c])/2;c=a.length%2?(a.length*b+b)/4:(a.length*b+2)/4;return c%1?(a[Math.floor(c)]+a[Math.floor(c)-1])/2:a[c-1]};B=function(a){var b;switch(a){case "undefined":a=void 0;break;case "null":a=null;break;case "true":a=!0;break;case "false":a=!1;break;default:b= parseFloat(a),a==b&&(a=b)}return a};G=function(a){var b,c=[];for(b=a.length;b--;)c[b]=B(a[b]);return c};O=function(a,b){var c,d,e=[];c=0;for(d=a.length;c<d;c++)a[c]!==b&&e.push(a[c]);return e};P=function(a){return!isNaN(parseFloat(a))&&isFinite(a)};S=function(a,b,c,d,e){var g;a=(!1===b?parseFloat(a).toString():a.toFixed(b)).split("");g=0>(g=f.inArray(".",a))?a.length:g;g<a.length&&(a[g]=e);for(b=g-c;0<b;b-=c)a.splice(b,0,d);return a.join("")};H=function(a,b,c){var d;for(d=b.length;d--;)if(!(c&&null=== b[d])&&b[d]!==a)return!1;return!0};R=function(a){return f.isArray(a)?a:[a]};Q=function(a){var b;document.createStyleSheet?document.createStyleSheet().cssText=a:(b=document.createElement("style"),b.type="text/css",document.getElementsByTagName("head")[0].appendChild(b),b["string"==typeof document.body.style.WebkitAppearance?"innerText":"innerHTML"]=a)};f.fn.simpledraw=function(a,b,c,d){var e;if(c&&(e=this.data("_jqs_vcanvas")))return e;void 0===a&&(a=f(this).innerWidth());void 0===b&&(b=f(this).innerHeight()); if(f.fn.sparkline.hasCanvas)e=new M(a,b,this,d);else if(f.fn.sparkline.hasVML)e=new N(a,b,this);else return!1;(a=f(this).data("_jqs_mhandler"))&&a.registerCanvas(e);return e};f.fn.cleardraw=function(){var a=this.data("_jqs_vcanvas");a&&a.reset()};f.RangeMapClass=D=p({init:function(a){var b,c,d=[];for(b in a)a.hasOwnProperty(b)&&("string"===typeof b&&-1<b.indexOf(":"))&&(c=b.split(":"),c[0]=0===c[0].length?-Infinity:parseFloat(c[0]),c[1]=0===c[1].length?Infinity:parseFloat(c[1]),c[2]=a[b],d.push(c)); this.map=a;this.rangelist=d||!1},get:function(a){var b=this.rangelist,c,d;if(void 0!==(c=this.map[a]))return c;if(b)for(c=b.length;c--;)if(d=b[c],d[0]<=a&&d[1]>=a)return d[2]}});f.range_map=function(a){return new D(a)};T=p({init:function(a,b){this.$el=f(a);this.options=b;this.currentPageY=this.currentPageX=0;this.el=a;this.splist=[];this.tooltip=null;this.over=!1;this.displayTooltips=!b.get("disableTooltips");this.highlightEnabled=!b.get("disableHighlight")},registerSparkline:function(a){this.splist.push(a); this.over&&this.updateDisplay()},registerCanvas:function(a){var b=f(a.canvas);this.canvas=a;this.$canvas=b;b.mouseenter(f.proxy(this.mouseenter,this));b.mouseleave(f.proxy(this.mouseleave,this));b.click(f.proxy(this.mouseclick,this))},reset:function(a){this.splist=[];this.tooltip&&a&&(this.tooltip.remove(),this.tooltip=void 0)},mouseclick:function(a){var b=f.Event("sparklineClick");b.originalEvent=a;b.sparklines=this.splist;this.$el.trigger(b)},mouseenter:function(a){f(document.body).unbind("mousemove.jqs"); f(document.body).bind("mousemove.jqs",f.proxy(this.mousemove,this));this.over=!0;this.currentPageX=a.pageX;this.currentPageY=a.pageY;this.currentEl=a.target;!this.tooltip&&this.displayTooltips&&(this.tooltip=new U(this.options),this.tooltip.updatePosition(a.pageX,a.pageY));this.updateDisplay()},mouseleave:function(){f(document.body).unbind("mousemove.jqs");var a=this.splist,b=a.length,c=!1,d,e;this.over=!1;this.currentEl=null;this.tooltip&&(this.tooltip.remove(),this.tooltip=null);for(e=0;e<b;e++)d= a[e],d.clearRegionHighlight()&&(c=!0);c&&this.canvas.render()},mousemove:function(a){this.currentPageX=a.pageX;this.currentPageY=a.pageY;this.currentEl=a.target;this.tooltip&&this.tooltip.updatePosition(a.pageX,a.pageY);this.updateDisplay()},updateDisplay:function(){var a=this.splist,b=a.length,c=!1,d=this.$canvas.offset(),e=this.currentPageX-d.left,g=this.currentPageY-d.top,m,k;if(this.over){for(m=0;m<b;m++)d=a[m],(k=d.setRegionHighlight(this.currentEl,e,g))&&(c=!0);if(c){c=f.Event("sparklineRegionChange"); c.sparklines=this.splist;this.$el.trigger(c);if(this.tooltip){c="";for(m=0;m<b;m++)d=a[m],c+=d.getCurrentRegionTooltip();this.tooltip.setContent(c)}this.disableHighlight||this.canvas.render()}null===k&&this.mouseleave()}}});U=p({sizeStyle:"position: static !important;display: block !important;visibility: hidden !important;float: left !important;",init:function(a){var b=a.get("tooltipClassname","jqstooltip"),c=this.sizeStyle;this.container=a.get("tooltipContainer")||document.body;this.tooltipOffsetX= a.get("tooltipOffsetX",10);this.tooltipOffsetY=a.get("tooltipOffsetY",12);f("#jqssizetip").remove();f("#jqstooltip").remove();this.sizetip=f("<div/>",{id:"jqssizetip",style:c,"class":b});this.tooltip=f("<div/>",{id:"jqstooltip","class":b}).appendTo(this.container);a=this.tooltip.offset();this.offsetLeft=a.left;this.offsetTop=a.top;this.hidden=!0;f(window).unbind("resize.jqs scroll.jqs");f(window).bind("resize.jqs scroll.jqs",f.proxy(this.updateWindowDims,this));this.updateWindowDims()},updateWindowDims:function(){this.scrollTop= f(window).scrollTop();this.scrollLeft=f(window).scrollLeft();this.scrollRight=this.scrollLeft+f(window).width();this.updatePosition()},getSize:function(a){this.sizetip.html(a).appendTo(this.container);this.width=this.sizetip.width()+1;this.height=this.sizetip.height();this.sizetip.remove()},setContent:function(a){a?(this.getSize(a),this.tooltip.html(a).css({width:this.width,height:this.height,visibility:"visible"}),this.hidden&&(this.hidden=!1,this.updatePosition())):(this.tooltip.css("visibility", "hidden"),this.hidden=!0)},updatePosition:function(a,b){if(void 0===a){if(void 0===this.mousex)return;a=this.mousex-this.offsetLeft;b=this.mousey-this.offsetTop}else this.mousex=a-=this.offsetLeft,this.mousey=b-=this.offsetTop;this.height&&(this.width&&!this.hidden)&&(b-=this.height+this.tooltipOffsetY,a+=this.tooltipOffsetX,b<this.scrollTop&&(b=this.scrollTop),a<this.scrollLeft?a=this.scrollLeft:a+this.width>this.scrollRight&&(a=this.scrollRight-this.width),this.tooltip.css({left:a,top:b}))},remove:function(){this.tooltip.remove(); this.sizetip.remove();this.sizetip=this.tooltip=void 0;f(window).unbind("resize.jqs scroll.jqs")}});f(function(){Q('.jqstooltip { position: absolute;left: 0px;top: 0px;visibility: hidden;background: rgb(0, 0, 0) transparent;background-color: white;filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000);-ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000)";color: black;font: 10px arial, san serif;text-align: left;white-space: nowrap;padding: 5px;border: 1px solid black;z-index: 10000;}.jqsfield { color: black;font: 10px arial, san serif;text-align: left;}')}); t=[];f.fn.sparkline=function(a,b){return this.each(function(){var c=new f.fn.sparkline.options(this,b),d=f(this),e,g;e=function(){var b,e,g,h;if("html"===a||void 0===a){b=this.getAttribute(c.get("tagValuesAttribute"));if(void 0===b||null===b)b=d.html();b=b.replace(/(^\s*\x3c!--)|(--\x3e\s*$)|\s+/g,"").split(",")}else b=a;e="auto"===c.get("width")?b.length*c.get("defaultPixelsPerValue"):c.get("width");if("auto"===c.get("height")){if(!c.get("composite")||!f.data(this,"_jqs_vcanvas"))h=document.createElement("span"), h.innerHTML="a",d.html(h),g=f(h).innerHeight()||f(h).height(),f(h).remove()}else g=c.get("height");c.get("disableInteraction")?h=!1:(h=f.data(this,"_jqs_mhandler"))?c.get("composite")||h.reset():(h=new T(this,c),f.data(this,"_jqs_mhandler",h));c.get("composite")&&!f.data(this,"_jqs_vcanvas")?f.data(this,"_jqs_errnotify")||(alert("Attempted to attach a composite sparkline to an element with no existing sparkline"),f.data(this,"_jqs_errnotify",!0)):(g=new (f.fn.sparkline[c.get("type")])(this,b,c,e, g),g.render(),h&&h.registerSparkline(g))};if(f(this).html()&&!c.get("disableHiddenCheck")&&f(this).is(":hidden")||"1.3.0">f.fn.jquery&&f(this).parents().is(":hidden")||!f(this).parents("body").length){if(!c.get("composite")&&f.data(this,"_jqs_pending"))for(g=t.length;g;g--)t[g-1][0]==this&&t.splice(g-1,1);t.push([this,e]);f.data(this,"_jqs_pending",!0)}else e.call(this)})};f.fn.sparkline.defaults={common:{type:"line",lineColor:"#00f",fillColor:"#cdf",defaultPixelsPerValue:3,width:"auto",height:"auto", composite:!1,tagValuesAttribute:"values",tagOptionsPrefix:"spark",enableTagOptions:!1,enableHighlight:!0,highlightLighten:1.4,tooltipSkipNull:!0,tooltipPrefix:"",tooltipSuffix:"",disableHiddenCheck:!1,numberFormatter:!1,numberDigitGroupCount:3,numberDigitGroupSep:",",numberDecimalMark:".",disableTooltips:!1,disableInteraction:!1},line:{spotColor:"#f80",highlightSpotColor:"#5f5",highlightLineColor:"",spotRadius:1.5,minSpotColor:"#f80",maxSpotColor:"#f80",lineWidth:1,normalRangeMin:void 0,normalRangeMax:void 0, normalRangeColor:"#ccc",drawNormalOnTop:!1,chartRangeMin:void 0,chartRangeMax:void 0,chartRangeMinX:void 0,chartRangeMaxX:void 0,tooltipFormat:new y("{{prefix}}{{y}}{{suffix}}")},bar:{barColor:"#3366cc",negBarColor:"#f44",stackedBarColor:"#3366cc #dc3912 #ff9900 #109618 #66aa00 #dd4477 #0099c6 #990099".split(" "),zeroColor:void 0,nullColor:void 0,zeroAxis:!0,barWidth:4,barSpacing:1,chartRangeMax:void 0,chartRangeMin:void 0,chartRangeClip:!1,colorMap:void 0,tooltipFormat:new y('<span style="color: {{color}}">&#9679;</span> {{prefix}}{{value}}{{suffix}}')}, tristate:{barWidth:4,barSpacing:1,posBarColor:"#6f6",negBarColor:"#f44",zeroBarColor:"#999",colorMap:{},tooltipFormat:new y('<span style="color: {{color}}">&#9679;</span> {{value:map}}'),tooltipValueLookups:{map:{"-1":"Loss","0":"Draw",1:"Win"}}},discrete:{lineHeight:"auto",thresholdColor:void 0,thresholdValue:0,chartRangeMax:void 0,chartRangeMin:void 0,chartRangeClip:!1,tooltipFormat:new y("{{prefix}}{{value}}{{suffix}}")},bullet:{targetColor:"#f33",targetWidth:3,performanceColor:"#33f",rangeColors:["#d3dafe", "#a8b6ff","#7f94ff"],base:void 0,tooltipFormat:new y("{{fieldkey:fields}} - {{value}}"),tooltipValueLookups:{fields:{r:"Range",p:"Performance",t:"Target"}}},pie:{offset:0,sliceColors:"#3366cc #dc3912 #ff9900 #109618 #66aa00 #dd4477 #0099c6 #990099".split(" "),borderWidth:0,borderColor:"#000",tooltipFormat:new y('<span style="color: {{color}}">&#9679;</span> {{value}} ({{percent.1}}%)')},box:{raw:!1,boxLineColor:"#000",boxFillColor:"#cdf",whiskerColor:"#000",outlierLineColor:"#333",outlierFillColor:"#fff", medianColor:"#f00",showOutliers:!0,outlierIQR:1.5,spotRadius:1.5,target:void 0,targetColor:"#4a2",chartRangeMax:void 0,chartRangeMin:void 0,tooltipFormat:new y("{{field:fields}}: {{value}}"),tooltipFormatFieldlistKey:"field",tooltipValueLookups:{fields:{lq:"Lower Quartile",med:"Median",uq:"Upper Quartile",lo:"Left Outlier",ro:"Right Outlier",lw:"Left Whisker",rw:"Right Whisker"}}}};f.sparkline_display_visible=function(){var a,b,c,d=[];b=0;for(c=t.length;b<c;b++)a=t[b][0],f(a).is(":visible")&&!f(a).parents().is(":hidden")? (t[b][1].call(a),f.data(t[b][0],"_jqs_pending",!1),d.push(b)):!f(a).closest("html").length&&!f.data(a,"_jqs_pending")&&(f.data(t[b][0],"_jqs_pending",!1),d.push(b));for(b=d.length;b;b--)t.splice(d[b-1],1)};f.fn.sparkline.options=p({init:function(a,b){var c,d,e;this.userOptions=b=b||{};this.tag=a;this.tagValCache={};c=f.fn.sparkline.defaults;d=c.common;this.tagOptionsPrefix=b.enableTagOptions&&(b.tagOptionsPrefix||d.tagOptionsPrefix);e=this.getTagSetting("type");this.mergedOptions=f.extend({},d,e=== E?c[b.type||d.type]:c[e],b)},getTagSetting:function(a){var b=this.tagOptionsPrefix,c,d;if(!1===b||void 0===b)return E;if(this.tagValCache.hasOwnProperty(a))a=this.tagValCache.key;else{a=this.tag.getAttribute(b+a);if(void 0===a||null===a)a=E;else if("["===a.substr(0,1)){a=a.substr(1,a.length-2).split(",");for(b=a.length;b--;)a[b]=B(a[b].replace(/(^\s*)|(\s*$)/g,""))}else if("{"===a.substr(0,1)){c=a.substr(1,a.length-2).split(",");a={};for(b=c.length;b--;)d=c[b].split(":",2),a[d[0].replace(/(^\s*)|(\s*$)/g, "")]=B(d[1].replace(/(^\s*)|(\s*$)/g,""))}else a=B(a);this.tagValCache.key=a}return a},get:function(a,b){var c=this.getTagSetting(a),d;return c!==E?c:void 0===(d=this.mergedOptions[a])?b:d}});f.fn.sparkline._base=p({disabled:!1,init:function(a,b,c,d,e){this.el=a;this.$el=f(a);this.values=b;this.options=c;this.width=d;this.height=e;this.currentRegion=void 0},initTarget:function(){var a=!this.options.get("disableInteraction");(this.target=this.$el.simpledraw(this.width,this.height,this.options.get("composite"), a))?(this.canvasWidth=this.target.pixelWidth,this.canvasHeight=this.target.pixelHeight):this.disabled=!0},render:function(){return this.disabled?(this.el.innerHTML="",!1):!0},getRegion:function(){},setRegionHighlight:function(a,b,c){var d=this.currentRegion,e=!this.options.get("disableHighlight");if(b>this.canvasWidth||c>this.canvasHeight||0>b||0>c)return null;a=this.getRegion(a,b,c);return d!==a?(void 0!==d&&e&&this.removeHighlight(),this.currentRegion=a,void 0!==a&&e&&this.renderHighlight(),!0): !1},clearRegionHighlight:function(){return void 0!==this.currentRegion?(this.removeHighlight(),this.currentRegion=void 0,!0):!1},renderHighlight:function(){this.changeHighlight(!0)},removeHighlight:function(){this.changeHighlight(!1)},changeHighlight:function(){},getCurrentRegionTooltip:function(){var a=this.options,b="",c=[],d,e,g,m,k,j,h,l,n;if(void 0===this.currentRegion)return"";d=this.getCurrentRegionFields();if(e=a.get("tooltipFormatter"))return e(this,a,d);a.get("tooltipChartTitle")&&(b+='<div class="jqs jqstitle">'+ a.get("tooltipChartTitle")+"</div>\n");e=this.options.get("tooltipFormat");if(!e)return"";f.isArray(e)||(e=[e]);f.isArray(d)||(d=[d]);g=this.options.get("tooltipFormatFieldlist");m=this.options.get("tooltipFormatFieldlistKey");if(g&&m){k=[];for(j=d.length;j--;)if(h=d[j][m],-1!=(h=f.inArray(h,g)))k[h]=d[j];d=k}g=e.length;n=d.length;for(j=0;j<g;j++){l=e[j];"string"===typeof l&&(l=new y(l));m=l.fclass||"jqsfield";for(h=0;h<n;h++)if(!d[h].isNull||!a.get("tooltipSkipNull"))f.extend(d[h],{prefix:a.get("tooltipPrefix"), suffix:a.get("tooltipSuffix")}),k=l.render(d[h],a.get("tooltipValueLookups"),a),c.push('<div class="'+m+'">'+k+"</div>")}return c.length?b+c.join("\n"):""},getCurrentRegionFields:function(){},calcHighlightColor:function(a,b){var c=b.get("highlightColor"),d=b.get("highlightLighten"),e,g,f;if(c)return c;if(d&&(c=/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(a)||/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(a))){g=[];e=4===a.length?16:1;for(f=0;3>f;f++)g[f]=C(Math.round(parseInt(c[f+1],16)*e*d),0,255); return"rgb("+g.join(",")+")"}return a}});z={changeHighlight:function(a){var b=this.currentRegion,c=this.target,d=this.regionShapes[b];d&&(a=this.renderRegion(b,a),f.isArray(a)||f.isArray(d)?(c.replaceWithShapes(d,a),this.regionShapes[b]=f.map(a,function(a){return a.id})):(c.replaceWithShape(d,a),this.regionShapes[b]=a.id))},render:function(){var a=this.values,b=this.target,c=this.regionShapes,d,e,g;if(this.cls._super.render.call(this)){for(e=a.length;e--;)if(a=this.renderRegion(e))if(f.isArray(a)){d= [];for(g=a.length;g--;)a[g].append(),d.push(a[g].id);c[e]=d}else a.append(),c[e]=a.id;else c[e]=null;b.render()}}};f.fn.sparkline.line=I=p(f.fn.sparkline._base,{type:"line",init:function(a,b,c,d,e){I._super.init.call(this,a,b,c,d,e);this.vertices=[];this.regionMap=[];this.xvalues=[];this.yvalues=[];this.yminmax=[];this.lastShapeId=this.hightlightSpotId=null;this.initTarget()},getRegion:function(a,b){var c,d=this.regionMap;for(c=d.length;c--;)if(null!==d[c]&&b>=d[c][0]&&b<=d[c][1])return d[c][2]}, getCurrentRegionFields:function(){var a=this.currentRegion;return{isNull:null===this.yvalues[a],x:this.xvalues[a],y:this.yvalues[a],color:this.options.get("lineColor"),fillColor:this.options.get("fillColor"),offset:a}},renderHighlight:function(){var a=this.target,b=this.vertices[this.currentRegion],c=this.options,d=c.get("spotRadius"),e=c.get("highlightSpotColor"),c=c.get("highlightLineColor");b&&(d&&e&&(d=a.drawCircle(b[0],b[1],d,void 0,e),this.highlightSpotId=d.id,a.insertAfterShape(this.lastShapeId, d)),c&&(b=a.drawLine(b[0],this.canvasTop,b[0],this.canvasTop+this.canvasHeight,c),this.highlightLineId=b.id,a.insertAfterShape(this.lastShapeId,b)))},removeHighlight:function(){var a=this.target;this.highlightSpotId&&(a.removeShapeId(this.highlightSpotId),this.highlightSpotId=null);this.highlightLineId&&(a.removeShapeId(this.highlightLineId),this.highlightLineId=null)},scanValues:function(){var a=this.values,b=a.length,c=this.xvalues,d=this.yvalues,e=this.yminmax,g,f,k,j,h;for(g=0;g<b;g++)f=a[g], k="string"===typeof a[g],j="object"===typeof a[g]&&a[g]instanceof Array,h=k&&a[g].split(":"),k&&2===h.length?(c.push(Number(h[0])),d.push(Number(h[1])),e.push(Number(h[1]))):j?(c.push(f[0]),d.push(f[1]),e.push(f[1])):(c.push(g),null===a[g]||"null"===a[g]?d.push(null):(d.push(Number(f)),e.push(Number(f))));this.options.get("xvalues")&&(c=this.options.get("xvalues"));this.maxy=this.maxyorg=Math.max.apply(Math,e);this.miny=this.minyorg=Math.min.apply(Math,e);this.maxx=Math.max.apply(Math,c);this.minx= Math.min.apply(Math,c);this.xvalues=c;this.yvalues=d;this.yminmax=e},processRangeOptions:function(){var a=this.options,b=a.get("normalRangeMin"),c=a.get("normalRangeMax");void 0!==b&&(b<this.miny&&(this.miny=b),c>this.maxy&&(this.maxy=c));if(void 0!==a.get("chartRangeMin")&&(a.get("chartRangeClip")||a.get("chartRangeMin")<this.miny))this.miny=a.get("chartRangeMin");if(void 0!==a.get("chartRangeMax")&&(a.get("chartRangeClip")||a.get("chartRangeMax")>this.maxy))this.maxy=a.get("chartRangeMax");if(void 0!== a.get("chartRangeMinX")&&(a.get("chartRangeClipX")||a.get("chartRangeMinX")<this.minx))this.minx=a.get("chartRangeMinX");if(void 0!==a.get("chartRangeMaxX")&&(a.get("chartRangeClipX")||a.get("chartRangeMaxX")>this.maxx))this.maxx=a.get("chartRangeMaxX")},drawNormalRange:function(a,b,c,d,e){var g=this.options.get("normalRangeMin"),f=this.options.get("normalRangeMax");b+=Math.round(c-c*((f-this.miny)/e));c=Math.round(c*(f-g)/e);this.target.drawRect(a,b,d,c,void 0,this.options.get("normalRangeColor")).append()}, render:function(){var a=this.options,b=this.target,c=this.canvasWidth,d=this.canvasHeight,e=this.vertices,g=a.get("spotRadius"),m=this.regionMap,k,j,h,l,n,r,q,v,s,A,p,x,t,w,u;if(I._super.render.call(this)&&(this.scanValues(),this.processRangeOptions(),t=this.xvalues,w=this.yvalues,this.yminmax.length&&!(2>this.yvalues.length))){l=n=0;k=0===this.maxx-this.minx?1:this.maxx-this.minx;j=0===this.maxy-this.miny?1:this.maxy-this.miny;h=this.yvalues.length-1;if(g&&(c<4*g||d<4*g))g=0;if(g){if((x=a.get("highlightSpotColor")&& !a.get("disableInteraction"))||a.get("minSpotColor")||a.get("spotColor")&&w[h]===this.miny)d-=Math.ceil(g);if(x||a.get("maxSpotColor")||a.get("spotColor")&&w[h]===this.maxy)d-=Math.ceil(g),l+=Math.ceil(g);if(x||(a.get("minSpotColor")||a.get("maxSpotColor"))&&(w[0]===this.miny||w[0]===this.maxy))n+=Math.ceil(g),c-=Math.ceil(g);if(x||a.get("spotColor")||a.get("minSpotColor")||a.get("maxSpotColor")&&(w[h]===this.miny||w[h]===this.maxy))c-=Math.ceil(g)}d--;void 0!==a.get("normalRangeMin")&&!a.get("drawNormalOnTop")&& this.drawNormalRange(n,l,d,c,j);q=[];v=[q];p=null;x=w.length;for(u=0;u<x;u++)s=t[u],A=t[u+1],r=w[u],s=n+Math.round((s-this.minx)*(c/k)),A=u<x-1?n+Math.round((A-this.minx)*(c/k)):c,A=s+(A-s)/2,m[u]=[p||0,A,u],p=A,null===r?u&&(null!==w[u-1]&&(q=[],v.push(q)),e.push(null)):(r<this.miny&&(r=this.miny),r>this.maxy&&(r=this.maxy),q.length||q.push([s,l+d]),r=[s,l+Math.round(d-d*((r-this.miny)/j))],q.push(r),e.push(r));e=[];m=[];p=v.length;for(u=0;u<p;u++)q=v[u],q.length&&(a.get("fillColor")&&(q.push([q[q.length- 1][0],l+d]),m.push(q.slice(0)),q.pop()),2<q.length&&(q[0]=[q[0][0],q[1][1]]),e.push(q));p=m.length;for(u=0;u<p;u++)b.drawShape(m[u],a.get("fillColor"),a.get("fillColor")).append();void 0!==a.get("normalRangeMin")&&a.get("drawNormalOnTop")&&this.drawNormalRange(n,l,d,c,j);p=e.length;for(u=0;u<p;u++)b.drawShape(e[u],a.get("lineColor"),void 0,a.get("lineWidth")).append();if(g&&a.get("valueSpots")){q=a.get("valueSpots");void 0===q.get&&(q=new D(q));for(u=0;u<x;u++)(v=q.get(w[u]))&&b.drawCircle(n+Math.round((t[u]- this.minx)*(c/k)),l+Math.round(d-d*((w[u]-this.miny)/j)),g,void 0,v).append()}g&&(a.get("spotColor")&&null!==w[h])&&b.drawCircle(n+Math.round((t[t.length-1]-this.minx)*(c/k)),l+Math.round(d-d*((w[h]-this.miny)/j)),g,void 0,a.get("spotColor")).append();this.maxy!==this.minyorg&&(g&&a.get("minSpotColor")&&(s=t[f.inArray(this.minyorg,w)],b.drawCircle(n+Math.round((s-this.minx)*(c/k)),l+Math.round(d-d*((this.minyorg-this.miny)/j)),g,void 0,a.get("minSpotColor")).append()),g&&a.get("maxSpotColor")&&(s= t[f.inArray(this.maxyorg,w)],b.drawCircle(n+Math.round((s-this.minx)*(c/k)),l+Math.round(d-d*((this.maxyorg-this.miny)/j)),g,void 0,a.get("maxSpotColor")).append()));this.lastShapeId=b.getLastShapeId();this.canvasTop=l;b.render()}}});f.fn.sparkline.bar=V=p(f.fn.sparkline._base,z,{type:"bar",init:function(a,b,c,d,e){var g=parseInt(c.get("barWidth"),10),m=parseInt(c.get("barSpacing"),10),k=c.get("chartRangeMin"),j=c.get("chartRangeMax"),h=c.get("chartRangeClip"),l=Infinity,n=-Infinity,r,q,v,s,p,t,x; V._super.init.call(this,a,b,c,d,e);a=0;for(d=b.length;a<d;a++)if(e=b[a],(r="string"===typeof e&&-1<e.indexOf(":"))||f.isArray(e))s=!0,r&&(e=b[a]=G(e.split(":"))),e=O(e,null),r=Math.min.apply(Math,e),e=Math.max.apply(Math,e),r<l&&(l=r),e>n&&(n=e);this.stacked=s;this.regionShapes={};this.barWidth=g;this.barSpacing=m;this.totalBarWidth=g+m;this.width=b.length*g+(b.length-1)*m;this.initTarget();h&&(v=void 0===k?-Infinity:k,q=void 0===j?Infinity:j);k=[];g=s?[]:k;j=[];m=[];a=0;for(d=b.length;a<d;a++)if(s){r= b[a];b[a]=x=[];j[a]=0;p=g[a]=m[a]=0;for(t=r.length;p<t;p++)e=x[p]=h?C(r[p],v,q):r[p],null!==e&&(0<e&&(j[a]+=e),0>l&&0<n?0>e?m[a]+=Math.abs(e):g[a]+=e:g[a]+=Math.abs(e-(0>e?n:l)),k.push(e))}else e=h?C(b[a],v,q):b[a],e=b[a]=B(e),null!==e&&k.push(e);this.max=h=Math.max.apply(Math,k);this.min=b=Math.min.apply(Math,k);this.stackMax=n=s?Math.max.apply(Math,j):h;this.stackMin=s?Math.min.apply(Math,k):b;if(void 0!==c.get("chartRangeMin")&&(c.get("chartRangeClip")||c.get("chartRangeMin")<b))b=c.get("chartRangeMin"); if(void 0!==c.get("chartRangeMax")&&(c.get("chartRangeClip")||c.get("chartRangeMax")>h))h=c.get("chartRangeMax");this.zeroAxis=l=c.get("zeroAxis",!0);this.xaxisOffset=v=0>=b&&0<=h&&l?0:!1==l?b:0<b?b:h;q=s?Math.max.apply(Math,g)+Math.max.apply(Math,m):h-b;this.canvasHeightEf=l&&0>b?this.canvasHeight-2:this.canvasHeight-1;b<v?(n=((s&&0<=h?n:h)-v)/q*this.canvasHeight,n!==Math.ceil(n)&&(this.canvasHeightEf-=2,n=Math.ceil(n))):n=this.canvasHeight;this.yoffset=n;if(f.isArray(c.get("colorMap")))this.colorMapByIndex= c.get("colorMap"),this.colorMapByValue=null;else if(this.colorMapByIndex=null,(this.colorMapByValue=c.get("colorMap"))&&void 0===this.colorMapByValue.get)this.colorMapByValue=new D(this.colorMapByValue);this.range=q},getRegion:function(a,b){var c=Math.floor(b/this.totalBarWidth);return 0>c||c>=this.values.length?void 0:c},getCurrentRegionFields:function(){var a=this.currentRegion,b=R(this.values[a]),c=[],d,e;for(e=b.length;e--;)d=b[e],c.push({isNull:null===d,value:d,color:this.calcColor(e,d,a),offset:a}); return c},calcColor:function(a,b,c){var d=this.colorMapByIndex,e=this.colorMapByValue,g=this.options,m,k;m=this.stacked?g.get("stackedBarColor"):0>b?g.get("negBarColor"):g.get("barColor");0===b&&void 0!==g.get("zeroColor")&&(m=g.get("zeroColor"));e&&(k=e.get(b))?m=k:d&&d.length>c&&(m=d[c]);return f.isArray(m)?m[a%m.length]:m},renderRegion:function(a,b){var c=this.values[a],d=this.options,e=this.xaxisOffset,g=[],m=this.range,k=this.stacked,j=this.target,h=a*this.totalBarWidth,l=this.canvasHeightEf, n=this.yoffset,r,q,v,s,p,t,x,y,c=f.isArray(c)?c:[c];t=c.length;r=H(null,c);y=H(e,c,!0);if(r){if(d.get("nullColor"))return v=b?d.get("nullColor"):this.calcHighlightColor(d.get("nullColor"),d),j.drawRect(h,0<n?n-1:n,this.barWidth-1,0,v,v)}else{s=n;for(p=0;p<t;p++){v=c[p];if(k&&v===e){if(!y||x)continue;x=!0}q=0<m?Math.floor(l*(Math.abs(v-e)/m))+1:1;v<e||v===e&&0===n?(r=s,s+=q):(r=n-q,n-=q);v=this.calcColor(p,v,a);b&&(v=this.calcHighlightColor(v,d));g.push(j.drawRect(h,r,this.barWidth-1,q-1,v,v))}return 1=== g.length?g[0]:g}}});f.fn.sparkline.tristate=W=p(f.fn.sparkline._base,z,{type:"tristate",init:function(a,b,c,d,e){var g=parseInt(c.get("barWidth"),10),m=parseInt(c.get("barSpacing"),10);W._super.init.call(this,a,b,c,d,e);this.regionShapes={};this.barWidth=g;this.barSpacing=m;this.totalBarWidth=g+m;this.values=f.map(b,Number);this.width=b.length*g+(b.length-1)*m;if(f.isArray(c.get("colorMap")))this.colorMapByIndex=c.get("colorMap"),this.colorMapByValue=null;else if(this.colorMapByIndex=null,(this.colorMapByValue= c.get("colorMap"))&&void 0===this.colorMapByValue.get)this.colorMapByValue=new D(this.colorMapByValue);this.initTarget()},getRegion:function(a,b){return Math.floor(b/this.totalBarWidth)},getCurrentRegionFields:function(){var a=this.currentRegion;return{isNull:void 0===this.values[a],value:this.values[a],color:this.calcColor(this.values[a],a),offset:a}},calcColor:function(a,b){var c=this.values,d=this.options,e=this.colorMapByIndex,g=this.colorMapByValue,f;return g&&(f=g.get(a))?f:e&&e.length>b?e[b]: 0>c[b]?d.get("negBarColor"):0<c[b]?d.get("posBarColor"):d.get("zeroBarColor")},renderRegion:function(a,b){var c=this.values,d=this.options,e=this.target,g,f,k;g=Math.round(e.pixelHeight/2);f=a*this.totalBarWidth;0>c[a]?(k=g,g-=1):0<c[a]?(k=0,g-=1):(k=g-1,g=2);c=this.calcColor(c[a],a);if(null!==c)return b&&(c=this.calcHighlightColor(c,d)),e.drawRect(f,k,this.barWidth-1,g-1,c,c)}});f.fn.sparkline.discrete=X=p(f.fn.sparkline._base,z,{type:"discrete",init:function(a,b,c,d,e){X._super.init.call(this,a, b,c,d,e);this.regionShapes={};this.values=b=f.map(b,Number);this.min=Math.min.apply(Math,b);this.max=Math.max.apply(Math,b);this.range=this.max-this.min;this.width=d="auto"===c.get("width")?2*b.length:this.width;this.interval=Math.floor(d/b.length);this.itemWidth=d/b.length;if(void 0!==c.get("chartRangeMin")&&(c.get("chartRangeClip")||c.get("chartRangeMin")<this.min))this.min=c.get("chartRangeMin");if(void 0!==c.get("chartRangeMax")&&(c.get("chartRangeClip")||c.get("chartRangeMax")>this.max))this.max= c.get("chartRangeMax");this.initTarget();this.target&&(this.lineHeight="auto"===c.get("lineHeight")?Math.round(0.3*this.canvasHeight):c.get("lineHeight"))},getRegion:function(a,b){return Math.floor(b/this.itemWidth)},getCurrentRegionFields:function(){var a=this.currentRegion;return{isNull:void 0===this.values[a],value:this.values[a],offset:a}},renderRegion:function(a,b){var c=this.options,d=this.min,e=this.range,g=this.interval,f=this.target,k=this.lineHeight,j=this.canvasHeight-k,h;h=C(this.values[a], d,this.max);g*=a;d=Math.round(j-j*((h-d)/e));h=c.get("thresholdColor")&&h<c.get("thresholdValue")?c.get("thresholdColor"):c.get("lineColor");b&&(h=this.calcHighlightColor(h,c));return f.drawLine(g,d,g,d+k,h)}});f.fn.sparkline.bullet=J=p(f.fn.sparkline._base,{type:"bullet",init:function(a,b,c,d,e){var g;J._super.init.call(this,a,b,c,d,e);this.values=b=G(b);a=b.slice();a[0]=null===a[0]?a[2]:a[0];a[1]=null===b[1]?a[2]:a[1];a=Math.min.apply(Math,b);g=Math.max.apply(Math,b);this.min=a=void 0===c.get("base")? 0>a?a:0:c.get("base");this.max=g;this.range=g-a;this.shapes={};this.valueShapes={};this.regiondata={};this.width=d="auto"===c.get("width")?"4.0em":d;this.target=this.$el.simpledraw(d,e,c.get("composite"));b.length||(this.disabled=!0);this.initTarget()},getRegion:function(a,b,c){a=this.target.getShapeAt(a,b,c);return void 0!==a&&void 0!==this.shapes[a]?this.shapes[a]:void 0},getCurrentRegionFields:function(){var a=this.currentRegion;return{fieldkey:a.substr(0,1),value:this.values[a.substr(1)],region:a}}, changeHighlight:function(a){var b=this.currentRegion,c=this.valueShapes[b],d;delete this.shapes[c];switch(b.substr(0,1)){case "r":d=this.renderRange(b.substr(1),a);break;case "p":d=this.renderPerformance(a);break;case "t":d=this.renderTarget(a)}this.valueShapes[b]=d.id;this.shapes[d.id]=b;this.target.replaceWithShape(c,d)},renderRange:function(a,b){var c=Math.round(this.canvasWidth*((this.values[a]-this.min)/this.range)),d=this.options.get("rangeColors")[a-2];b&&(d=this.calcHighlightColor(d,this.options)); return this.target.drawRect(0,0,c-1,this.canvasHeight-1,d,d)},renderPerformance:function(a){var b=Math.round(this.canvasWidth*((this.values[1]-this.min)/this.range)),c=this.options.get("performanceColor");a&&(c=this.calcHighlightColor(c,this.options));return this.target.drawRect(0,Math.round(0.3*this.canvasHeight),b-1,Math.round(0.4*this.canvasHeight)-1,c,c)},renderTarget:function(a){var b=Math.round(this.canvasWidth*((this.values[0]-this.min)/this.range)-this.options.get("targetWidth")/2),c=Math.round(0.1* this.canvasHeight),d=this.canvasHeight-2*c,e=this.options.get("targetColor");a&&(e=this.calcHighlightColor(e,this.options));return this.target.drawRect(b,c,this.options.get("targetWidth")-1,d-1,e,e)},render:function(){var a=this.values.length,b=this.target,c,d;if(J._super.render.call(this)){for(c=2;c<a;c++)d=this.renderRange(c).append(),this.shapes[d.id]="r"+c,this.valueShapes["r"+c]=d.id;null!==this.values[1]&&(d=this.renderPerformance().append(),this.shapes[d.id]="p1",this.valueShapes.p1=d.id); null!==this.values[0]&&(d=this.renderTarget().append(),this.shapes[d.id]="t0",this.valueShapes.t0=d.id);b.render()}}});f.fn.sparkline.pie=K=p(f.fn.sparkline._base,{type:"pie",init:function(a,b,c,d,e){var g=0;K._super.init.call(this,a,b,c,d,e);this.shapes={};this.valueShapes={};this.values=b=f.map(b,Number);"auto"===c.get("width")&&(this.width=this.height);if(0<b.length)for(a=b.length;a--;)g+=b[a];this.total=g;this.initTarget();this.radius=Math.floor(Math.min(this.canvasWidth,this.canvasHeight)/2)}, getRegion:function(a,b,c){a=this.target.getShapeAt(a,b,c);return void 0!==a&&void 0!==this.shapes[a]?this.shapes[a]:void 0},getCurrentRegionFields:function(){var a=this.currentRegion;return{isNull:void 0===this.values[a],value:this.values[a],percent:100*(this.values[a]/this.total),color:this.options.get("sliceColors")[a%this.options.get("sliceColors").length],offset:a}},changeHighlight:function(a){var b=this.currentRegion;a=this.renderSlice(b,a);var c=this.valueShapes[b];delete this.shapes[c];this.target.replaceWithShape(c, a);this.valueShapes[b]=a.id;this.shapes[a.id]=b},renderSlice:function(a,b){var c=this.target,d=this.options,e=this.radius,g=d.get("borderWidth"),f=d.get("offset"),k=2*Math.PI,j=this.values,h=this.total,l=f?2*Math.PI*(f/360):0,n,r,q;q=j.length;for(r=0;r<q;r++){n=f=l;0<h&&(n=l+k*(j[r]/h));if(a===r)return k=d.get("sliceColors")[r%d.get("sliceColors").length],b&&(k=this.calcHighlightColor(k,d)),c.drawPieSlice(e,e,e-g,f,n,void 0,k);l=n}},render:function(){var a=this.target,b=this.values,c=this.options, d=this.radius,e=c.get("borderWidth");if(K._super.render.call(this)){e&&a.drawCircle(d,d,Math.floor(d-e/2),c.get("borderColor"),void 0,e).append();for(d=b.length;d--;)b[d]&&(c=this.renderSlice(d).append(),this.valueShapes[d]=c.id,this.shapes[c.id]=d);a.render()}}});f.fn.sparkline.box=L=p(f.fn.sparkline._base,{type:"box",init:function(a,b,c,d,e){L._super.init.call(this,a,b,c,d,e);this.values=f.map(b,Number);this.width="auto"===c.get("width")?"4.0em":d;this.initTarget();this.values.length||(this.disabled= 1)},getRegion:function(){return 1},getCurrentRegionFields:function(){var a=[{field:"lq",value:this.quartiles[0]},{field:"med",value:this.quartiles[1]},{field:"uq",value:this.quartiles[2]}];void 0!==this.loutlier&&a.push({field:"lo",value:this.loutlier});void 0!==this.routlier&&a.push({field:"ro",value:this.routlier});void 0!==this.lwhisker&&a.push({field:"lw",value:this.lwhisker});void 0!==this.rwhisker&&a.push({field:"rw",value:this.rwhisker});return a},render:function(){var a=this.target,b=this.values, c=b.length,d=this.options,e=this.canvasWidth,g=this.canvasHeight,f=void 0===d.get("chartRangeMin")?Math.min.apply(Math,b):d.get("chartRangeMin"),k=void 0===d.get("chartRangeMax")?Math.max.apply(Math,b):d.get("chartRangeMax"),j=0,h,l,n,r,q,p,s,t;if(L._super.render.call(this)){if(d.get("raw"))d.get("showOutliers")&&5<b.length?(l=b[0],h=b[1],r=b[2],q=b[3],p=b[4],s=b[5],t=b[6]):(h=b[0],r=b[1],q=b[2],p=b[3],s=b[4]);else if(b.sort(function(a,b){return a-b}),r=F(b,1),q=F(b,2),p=F(b,3),n=p-r,d.get("showOutliers")){h= s=void 0;for(l=0;l<c;l++)void 0===h&&b[l]>r-n*d.get("outlierIQR")&&(h=b[l]),b[l]<p+n*d.get("outlierIQR")&&(s=b[l]);l=b[0];t=b[c-1]}else h=b[0],s=b[c-1];this.quartiles=[r,q,p];this.lwhisker=h;this.rwhisker=s;this.loutlier=l;this.routlier=t;b=e/(k-f+1);d.get("showOutliers")&&(j=Math.ceil(d.get("spotRadius")),e-=2*Math.ceil(d.get("spotRadius")),b=e/(k-f+1),l<h&&a.drawCircle((l-f)*b+j,g/2,d.get("spotRadius"),d.get("outlierLineColor"),d.get("outlierFillColor")).append(),t>s&&a.drawCircle((t-f)*b+j,g/2, d.get("spotRadius"),d.get("outlierLineColor"),d.get("outlierFillColor")).append());a.drawRect(Math.round((r-f)*b+j),Math.round(0.1*g),Math.round((p-r)*b),Math.round(0.8*g),d.get("boxLineColor"),d.get("boxFillColor")).append();a.drawLine(Math.round((h-f)*b+j),Math.round(g/2),Math.round((r-f)*b+j),Math.round(g/2),d.get("lineColor")).append();a.drawLine(Math.round((h-f)*b+j),Math.round(g/4),Math.round((h-f)*b+j),Math.round(g-g/4),d.get("whiskerColor")).append();a.drawLine(Math.round((s-f)*b+j),Math.round(g/ 2),Math.round((p-f)*b+j),Math.round(g/2),d.get("lineColor")).append();a.drawLine(Math.round((s-f)*b+j),Math.round(g/4),Math.round((s-f)*b+j),Math.round(g-g/4),d.get("whiskerColor")).append();a.drawLine(Math.round((q-f)*b+j),Math.round(0.1*g),Math.round((q-f)*b+j),Math.round(0.9*g),d.get("medianColor")).append();d.get("target")&&(e=Math.ceil(d.get("spotRadius")),a.drawLine(Math.round((d.get("target")-f)*b+j),Math.round(g/2-e),Math.round((d.get("target")-f)*b+j),Math.round(g/2+e),d.get("targetColor")).append(), a.drawLine(Math.round((d.get("target")-f)*b+j-e),Math.round(g/2),Math.round((d.get("target")-f)*b+j+e),Math.round(g/2),d.get("targetColor")).append());a.render()}}});document.namespaces&&!document.namespaces.v?(f.fn.sparkline.hasVML=!0,document.namespaces.add("v","urn:schemas-microsoft-com:vml","#default#VML")):f.fn.sparkline.hasVML=!1;z=document.createElement("canvas");f.fn.sparkline.hasCanvas=!(!z.getContext||!z.getContext("2d"));Y=p({init:function(a,b,c,d){this.target=a;this.id=b;this.type=c;this.args= d},append:function(){this.target.appendShape(this);return this}});z=p({_pxregex:/(\d+)(px)?\s*$/i,init:function(a,b,c){a&&(this.width=a,this.height=b,this.target=c,this.lastShapeId=null,c[0]&&(c=c[0]),f.data(c,"_jqs_vcanvas",this))},drawLine:function(a,b,c,d,e,g){return this.drawShape([[a,b],[c,d]],e,g)},drawShape:function(a,b,c,d){return this._genShape("Shape",[a,b,c,d])},drawCircle:function(a,b,c,d,e,g){return this._genShape("Circle",[a,b,c,d,e,g])},drawPieSlice:function(a,b,c,d,e,g,f){return this._genShape("PieSlice", [a,b,c,d,e,g,f])},drawRect:function(a,b,c,d,e,g){return this._genShape("Rect",[a,b,c,d,e,g])},getElement:function(){return this.canvas},getLastShapeId:function(){return this.lastShapeId},reset:function(){alert("reset not implemented")},_insert:function(a,b){f(b).html(a)},_calculatePixelDims:function(a,b,c){this.pixelHeight=(b=this._pxregex.exec(b))?b[1]:f(c).height();this.pixelWidth=(b=this._pxregex.exec(a))?b[1]:f(c).width()},_genShape:function(a,b){var c=Z++;b.unshift(c);return new Y(this,c,a,b)}, appendShape:function(){alert("appendShape not implemented")},replaceWithShape:function(){alert("replaceWithShape not implemented")},insertAfterShape:function(){alert("insertAfterShape not implemented")},removeShapeId:function(){alert("removeShapeId not implemented")},getShapeAt:function(){alert("getShapeAt not implemented")},render:function(){alert("render not implemented")}});M=p(z,{init:function(a,b,c,d){M._super.init.call(this,a,b,c);this.canvas=document.createElement("canvas");c[0]&&(c=c[0]); f.data(c,"_jqs_vcanvas",this);f(this.canvas).css({display:"inline-block",width:a,height:b,verticalAlign:"top"});this._insert(this.canvas,c);this._calculatePixelDims(a,b,this.canvas);this.canvas.width=this.pixelWidth;this.canvas.height=this.pixelHeight;this.interact=d;this.shapes={};this.shapeseq=[];this.currentTargetShapeId=void 0;f(this.canvas).css({width:this.pixelWidth,height:this.pixelHeight})},_getContext:function(a,b,c){var d=this.canvas.getContext("2d");void 0!==a&&(d.strokeStyle=a);d.lineWidth= void 0===c?1:c;void 0!==b&&(d.fillStyle=b);return d},reset:function(){this._getContext().clearRect(0,0,this.pixelWidth,this.pixelHeight);this.shapes={};this.shapeseq=[];this.currentTargetShapeId=void 0},_drawShape:function(a,b,c,d,e){e=this._getContext(c,d,e);var g,f;e.beginPath();e.moveTo(b[0][0]+0.5,b[0][1]+0.5);g=1;for(f=b.length;g<f;g++)e.lineTo(b[g][0]+0.5,b[g][1]+0.5);void 0!==c&&e.stroke();void 0!==d&&e.fill();void 0!==this.targetX&&(void 0!==this.targetY&&e.isPointInPath(this.targetX,this.targetY))&& (this.currentTargetShapeId=a)},_drawCircle:function(a,b,c,d,e,g,f){f=this._getContext(e,g,f);f.beginPath();f.arc(b,c,d,0,2*Math.PI,!1);void 0!==this.targetX&&(void 0!==this.targetY&&f.isPointInPath(this.targetX,this.targetY))&&(this.currentTargetShapeId=a);void 0!==e&&f.stroke();void 0!==g&&f.fill()},_drawPieSlice:function(a,b,c,d,e,g,f,k){var j=this._getContext(f,k);j.beginPath();j.moveTo(b,c);j.arc(b,c,d,e,g,!1);j.lineTo(b,c);j.closePath();void 0!==f&&j.stroke();k&&j.fill();void 0!==this.targetX&& (void 0!==this.targetY&&j.isPointInPath(this.targetX,this.targetY))&&(this.currentTargetShapeId=a)},_drawRect:function(a,b,c,d,e,g,f){return this._drawShape(a,[[b,c],[b+d,c],[b+d,c+e],[b,c+e],[b,c]],g,f)},appendShape:function(a){this.shapes[a.id]=a;this.shapeseq.push(a.id);return this.lastShapeId=a.id},replaceWithShape:function(a,b){var c=this.shapeseq,d;this.shapes[b.id]=b;for(d=c.length;d--;)c[d]==a&&(c[d]=b.id);delete this.shapes[a]},replaceWithShapes:function(a,b){var c=this.shapeseq,d={},e,g, f;for(g=a.length;g--;)d[a[g]]=!0;for(g=c.length;g--;)e=c[g],d[e]&&(c.splice(g,1),delete this.shapes[e],f=g);for(g=b.length;g--;)c.splice(f,0,b[g].id),this.shapes[b[g].id]=b[g]},insertAfterShape:function(a,b){var c=this.shapeseq,d;for(d=c.length;d--;)if(c[d]===a){c.splice(d+1,0,b.id);this.shapes[b.id]=b;break}},removeShapeId:function(a){var b=this.shapeseq,c;for(c=b.length;c--;)if(b[c]===a){b.splice(c,1);break}delete this.shapes[a]},getShapeAt:function(a,b,c){this.targetX=b;this.targetY=c;this.render(); return this.currentTargetShapeId},render:function(){var a=this.shapeseq,b=this.shapes,c=a.length,d,e;this._getContext().clearRect(0,0,this.pixelWidth,this.pixelHeight);for(e=0;e<c;e++)d=a[e],d=b[d],this["_draw"+d.type].apply(this,d.args);this.interact||(this.shapes={},this.shapeseq=[])}});N=p(z,{init:function(a,b,c){N._super.init.call(this,a,b,c);c[0]&&(c=c[0]);f.data(c,"_jqs_vcanvas",this);this.canvas=document.createElement("span");f(this.canvas).css({display:"inline-block",position:"relative",overflow:"hidden", width:a,height:b,margin:"0px",padding:"0px",verticalAlign:"top"});this._insert(this.canvas,c);this._calculatePixelDims(a,b,this.canvas);this.canvas.width=this.pixelWidth;this.canvas.height=this.pixelHeight;this.canvas.insertAdjacentHTML("beforeEnd",'<v:group coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'" style="position:absolute;top:0;left:0;width:'+this.pixelWidth+"px;height="+this.pixelHeight+'px;"></v:group>');this.group=f(this.canvas).children()[0];this.rendered=!1;this.prerender= ""},_drawShape:function(a,b,c,d,e){var g=[],f,k;k=0;for(f=b.length;k<f;k++)g[k]=""+b[k][0]+","+b[k][1];b=g.splice(0,1);c=void 0===c?' stroked="false" ':' strokeWeight="'+(void 0===e?1:e)+'px" strokeColor="'+c+'" ';e=g[0]===g[g.length-1]?"x ":"";return'<v:shape coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'" id="jqsshape'+a+'" '+c+(void 0===d?' filled="false"':' fillColor="'+d+'" filled="true" ')+' style="position:absolute;left:0px;top:0px;height:'+this.pixelHeight+"px;width:"+ this.pixelWidth+'px;padding:0px;margin:0px;" path="m '+b+" l "+g.join(", ")+" "+e+'e"> </v:shape>'},_drawCircle:function(a,b,c,d,e,g,f){return'<v:oval id="jqsshape'+a+'" '+(void 0===e?' stroked="false" ':' strokeWeight="'+f+'px" strokeColor="'+e+'" ')+(void 0===g?' filled="false"':' fillColor="'+g+'" filled="true" ')+' style="position:absolute;top:'+(c-d)+"px; left:"+(b-d)+"px; width:"+2*d+"px; height:"+2*d+'px"></v:oval>'},_drawPieSlice:function(a,b,c,d,e,g,f,k){var j,h,l,n;if(e===g)return"";g- e===2*Math.PI&&(e=0,g=2*Math.PI);j=b+Math.round(Math.cos(e)*d);h=c+Math.round(Math.sin(e)*d);l=b+Math.round(Math.cos(g)*d);n=c+Math.round(Math.sin(g)*d);if(j===l&&h===n){if(g-e<Math.PI)return"";j=l=b+d;h=n=c}return j===l&&h===n&&g-e<Math.PI?"":'<v:shape coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'" id="jqsshape'+a+'" '+(void 0===f?' stroked="false" ':' strokeWeight="1px" strokeColor="'+f+'" ')+(void 0===k?' filled="false"':' fillColor="'+k+'" filled="true" ')+' style="position:absolute;left:0px;top:0px;height:'+ this.pixelHeight+"px;width:"+this.pixelWidth+'px;padding:0px;margin:0px;" path="m '+b+","+c+" wa "+[b-d,c-d,b+d,c+d,j,h,l,n].join(", ")+' x e"> </v:shape>'},_drawRect:function(a,b,c,d,e,f,m){return this._drawShape(a,[[b,c],[b,c+e],[b+d,c+e],[b+d,c],[b,c]],f,m)},reset:function(){this.group.innerHTML=""},appendShape:function(a){var b=this["_draw"+a.type].apply(this,a.args);this.rendered?this.group.insertAdjacentHTML("beforeEnd",b):this.prerender+=b;return this.lastShapeId=a.id},replaceWithShape:function(a, b){var c=f("#jqsshape"+a),d=this["_draw"+b.type].apply(this,b.args);c[0].outerHTML=d},replaceWithShapes:function(a,b){var c=f("#jqsshape"+a[0]),d="",e=b.length,g;for(g=0;g<e;g++)d+=this["_draw"+b[g].type].apply(this,b[g].args);c[0].outerHTML=d;for(g=1;g<a.length;g++)f("#jqsshape"+a[g]).remove()},insertAfterShape:function(a,b){var c=f("#jqsshape"+a),d=this["_draw"+b.type].apply(this,b.args);c[0].insertAdjacentHTML("afterEnd",d)},removeShapeId:function(a){a=f("#jqsshape"+a);this.group.removeChild(a[0])}, getShapeAt:function(a){return a.id.substr(8)},render:function(){this.rendered||(this.group.innerHTML=this.prerender,this.rendered=!0)}})});